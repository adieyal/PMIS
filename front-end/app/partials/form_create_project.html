<h1 class="page-header">
    Create project
</h1>
<div class="row-fluid">

    <div class="span8">

        <div ng-switch="getCurrentStep()" ng-animate="'wave'" class="slide-frame">
            <div ng-switch-when="one" ng-form='step1form'>
                <h4>Project details</h4>
                <fieldset >
                    <div class="row-fluid">
                        <div class="span4">
                            <p>
                                Programme:
                            </p>
                        </div>
                        <div class="span4">
                            <select name="programme" class="input-large" ng-model="wizard.project.programme" ng-options="p.name for p in programmes" ng-required="true">
                            </select>
                        </div>
                        <div class="span4">
                            <p class="error" ng-show="step1form.select.$error.required">Required!</p>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            <p>
                                Name:
                            </p>
                        </div>
                        <div class="span4">
                            <input type="text" class="input-large" id="name" ng-model="wizard.project.name" ng-required="true">
                        </div>
                        <div class="span4">
                            <p class="error" ng-show="step1form.input.$error.required">Required!</p>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            <p>
                                Project number:
                            </p>
                        </div>
                        <div class="span4">
                            <input type="text" class="input-large" id="project_number" ng-model="wizard.project.project_number" ng-pattern="number">
                        </div>
                        <div class="span4"></div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                            <p>
                                Description:
                            </p>
                        </div>
                        <div class="span4">
                            <textarea class='input-large' name="description" id="description" cols="30" rows="10" ng-model="wizard.project.description"></textarea>
                        </div>
                        <div class="span4"></div>
                    </div>
                </fieldset>
                <a class="btn btn-primary" ng-disabled="!step1form.$valid" ng-click="handleNext(dismiss,step1form.$valid)">Continue to location</a>
            </div>
            <div ng-switch-when="two" ng-form="step2form">
                <h4>Project location and scope</h4>
                <ul class="breadcrumb">
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(0)}" ng-click="setCurrentStep(0)">Project details</a> <span class="divider">/</span></li>
                    <li ng-class="{'active':isCurrentStep(1)}"><span  ng-class="{'':isCurrentStep(1)}" ng-click="setCurrentStep(1)">Project location and scope</span> <span class="divider">/</span></li>
                </ul>
                <fieldset>
                    <table>
                        <tr>
                            <td class="span4">
                                <label class="control-label" for="district">District:</label>
                            </td>
                            <td class="span4">
                                <select name="programme" class="input-large" id="district" ng-change='get_municipality()' ng-model="wizard.district" ng-options="d.name for d in districts" ng-required="true">
                                </select>
                            </td>
                            <td>
                                <label class="control-label" >Municipality:</label>
                            </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td>
                                <div class="row-fluid" ng-repeat="municipality in wizard.project.municipalities">
                                    <div class="span6">
                                        <label class="control-label" for="municipality-{{ municipality.id }}">{{ municipality.name }}</label>
                                    </div>
                                    <div class="span6">
                                        <input type="checkbox" ng-model="municipality.selected" custom-validate>
                                    </div>
                                </div>

                            </td>
                            <td></td>
                        </tr>
                        <tr  ng-repeat="s in wizard.scope_of_work">
                            <td>
                                <label class="control-label">Scope:</label>
                            </td>
                            <td>
                                <input type="text" class="input-large" ng-model="s.quantity" ng-required="true" ng-pattern="number">
                            </td>
                            <td>

                                <select class="input-large" ng-model="s.scope_code" ng-options="sc.name for sc in scope_codes" ng-required="true">
                                </select>
                            </td>
                            <td>
                                <i ng-show="$index" class="icon-remove" ng-click="removeScopeOfWork(s)"></i>
                            </td>
                        </tr>
                    </table>


                    <a href="" onclick="return false" ng-click="addScopeOfWork()" >+ Add</a>

                </fieldset>
                <div >
                    <a class="btn" ng-click="handlePrevious()" ng-show="!isFirstStep()">Back</a>
                    <a class="btn btn-primary" ng-disabled="!(step2form.$valid&&wizard.project.municipalities|is_check)" ng-click="handleNext(dismiss,(step2form.$valid&&wizard.project.municipalities|is_check))">Continue to project people</a>
                </div>
            </div>
            <div ng-switch-when="three" ng-form='step3form'>
                <h4>Project people</h4>
                <ul class="breadcrumb">
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(0)}" ng-click="setCurrentStep(0)">Project details</a> <span class="divider">/</span></li>
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(1)}" ng-click="setCurrentStep(1)">Project location and scope</a> <span class="divider">/</span></li>
                    <li ng-class="{'active':isCurrentStep(2)}"><span  ng-class="{'':isCurrentStep(2)}" ng-click="setCurrentStep(1)">Project people</span> <span class="divider">/</span></li>
                </ul>
                <fieldset>
                    <table>
                        <tr ng-repeat="role in roles">
                            <td class="span6">
                                {{ role.name }}:
                            </td>
                            <td class="span6">
                                <input type="text" class="input-xlarge" id="role-{{ role.id }}" name="role-{{ role.id }}" auto-complete ui-items="entities" ng-model="wizard.project_role['role-'+role.id]" ng-required="true">
                            </td>
                        </tr>
                    </table>
                </fieldset>
                <div >
                    <a class="btn" ng-click="handlePrevious()" ng-show="!isFirstStep()">Back</a>
                    <a class="btn btn-primary" ng-disabled="!step3form.$valid" ng-click="handleNext(dismiss, step3form.$valid)">Continue to milestone</a>
                </div>
            </div>
            <div ng-switch-when="four" ng-form="step4form">
                <h4>Milestone</h4>
                <ul class="breadcrumb">
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(0)}" ng-click="setCurrentStep(0)">Project details</a> <span class="divider">/</span></li>
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(1)}" ng-click="setCurrentStep(1)">Project location and scope</a> <span class="divider">/</span></li>
                    <li><a onclick="return false;"  ng-class="{'':isCurrentStep(2)}" ng-click="setCurrentStep(2)">Project people</a> <span class="divider">/</span></li>
                    <li ng-class="{'active':isCurrentStep(3)}"><span  ng-class="{'':isCurrentStep(3)}" ng-click="setCurrentStep(3)">Milestone</span> <span class="divider">/</span></li>
                </ul>
                <fieldset>
                    <table class="span12">
                        <tr>
                            <td class="span6">
                                <label class="control-label" for="project_planing_budget">Project planing budget:</label>
                            </td>
                            <td class="span6">
                                <input type="text" id="project_planing_budget" ng-model="wizard.project_planing_budget">
                            </td>
                        </tr>
                        <tr >
                            <td colspan="2">
                                <accordion close-others="true">
                                    <accordion-group  ng-repeat="phase in phases" heading="+ {{ phase|capitalize }}">
                                        <fieldset class="well well-large">
                                            <legend>Dates</legend>
                                            <div class="row-fluid" ng-repeat="milestone in wizard.project_milestones | filter:{phase:[phase]} | orderBy:order">
                                                <div class="span6">
                                                    <p>
                                                        {{ milestone.name }}:
                                                    </p>
                                                </div>
                                                <div class="span6">
                                                    <input type="text" class="input-small" ng-model="milestone.completion_date" datepicker ng-required="true">
                                                </div>
                                            </div>
                                        </fieldset>
                                    </accordion-group>
                                    <accordion-group  heading="+ Overall">
                                    <fieldset class="well well-large">
                                        <div class="row-fluid">
                                            <div class="span6">Start date:</div>
                                            <div class="span6">
                                                <input type="text" class="input-small" ng-model="wizard.start_date" datepicker placeholder="prepopulated from first milestone">
                                            </div>
                                        </div>
                                        <div class="row-fluid">
                                            <div class="span6">Anticipated cost:</div>
                                            <div class="span6">
                                                <input type="text" class="input-medium" ng-model="wizard.project_financial.total_anticipated_cost" ng-pattern="number">
                                            </div>
                                        </div>
                                        <div class="row-fluid">
                                            <div class="span12">
                                                <fieldset class="well well-large">
                                                    <legend>Annual Budget Allocation</legend>
                                                    <div class="row-fluid" ng-repeat="y in years">
                                                        <div class="span3">
                                                            {{ y.0.name }}
                                                        </div>
                                                        <div class="span3">
                                                            <input type="text" class="input-mini" placeholder="amount" ng-model="y.0.amount">
                                                        </div>
                                                        <div class="span3">
                                                            {{ y.1.name }}
                                                        </div>
                                                        <div class="span3">
                                                            <input type="text" class="input-mini" placeholder="amount" ng-model="y.1.amount">
                                                        </div>

                                                    </div>

                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="row-fluid">
                                            <div class="span12">
                                                <fieldset class="well well-large">
                                                    <legend>Cashflow and Progress</legend>
                                                    <accordion close-others="true">
                                                        <accordion-group  ng-repeat="planning in wizard.planning" heading="+ {{ planning.name }}">
                                                            <fieldset class="well well-large">
                                                                <div class="row-fluid">
                                                                    <div class="span6">
                                                                        <div class="row-fluid">
                                                                            <div class="span2"></div>
                                                                            <div class="span5">
                                                                               <p class="text-center">
                                                                                   Expenditure
                                                                               </p>
                                                                            </div>
                                                                            <div class="span5">
                                                                                <p class="text-center">
                                                                                    Progress
                                                                                </p>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="span6">
                                                                        <div class="row-fluid">
                                                                            <div class="span2"></div>
                                                                            <div class="span5">
                                                                                <p class="text-center">
                                                                                    Expenditure
                                                                                </p>
                                                                            </div>
                                                                            <div class="span5">
                                                                                <p class="text-center">
                                                                                    Progress
                                                                                </p>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row-fluid" ng-repeat="i in [0,1,2,3,4,5]">
                                                                    <div class="span6" ng-repeat="item in planning.month.slice($index*2,$index*2+2)">
                                                                        <div class="row-fluid">
                                                                            <div class="span2">
                                                                                {{ item.name }}
                                                                            </div>
                                                                            <div class="span5">
                                                                                <input type="text" class="input-mini" placeholder="amount" ng-model='item.planning.amount' ng-pattern="number">

                                                                            </div>
                                                                            <div class="span5">
                                                                                <input type="text" class="input-mini" placeholder="%" ng-model="item.planning.progress" ng-pattern="number">

                                                                            </div>
                                                                        </div>


                                                                    </div>
                                                                </div>
                                                            </fieldset>
                                                        </accordion-group>
                                                    </accordion>
                                                </fieldset>
                                            </div>
                                        </div>

                                    </fieldset>
                                </accordion-group>

                                </accordion>

                            </td>
                        </tr>
                    </table>

                </fieldset>
                <div >
                    <a class="btn" ng-click="handlePrevious()" ng-show="!isFirstStep()">Back</a>
                    <a class="btn btn-primary" ng-disabled="!step4form.$valid" ng-click="handleNext(dismiss, step4form.$valid)">{{ getNextLabel() }}</a>
                </div>
            </div>

        </div>
    </div>
</div>
